<!DOCTYPE html>
<html>
  <head>
    <title>Random City Generator</title>
    <style>
      #cityCanvas {
        border: 1px solid #000;
      }
    </style>
  </head>
  <body>
    <canvas id="cityCanvas" width="500" height="300"></canvas>

    <script>
      const canvas = document.getElementById('cityCanvas');
      const canvasWidth = canvas.width;
      const canvasHeight = canvas.height;

      // Function to generate a random number within a range
      function getRandomNumber(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
      }

      // Function to generate a random city
      function generateRandomCity(cityLength, cityHeight, minBuildingHeight, subwayHeight, minBuildingWidth, maxBuildingWidth, minBuildingDistance, maxBuildingDistance) {
        // Array to store the city layout
        var cityLayout = [];
        const roadPosition = Math.floor(cityHeight / 2)

        const buildings = []

        // Prepare building width dimensions
        for (let position = 0; position < cityLength; position += getRandomNumber(minBuildingDistance, maxBuildingDistance)) {
          const width = getRandomNumber(minBuildingWidth, maxBuildingWidth)

          if (position + width > cityLength) {
            break
          }

          buildings.push([position, width])
          position += width
        }

        // Generate the road
        var road = {
          type: 'road',
          x: 0,
          y: roadPosition,
          width: cityLength,
          height: 1
        };
        cityLayout.push(road);

        // Generate the subway
        var subway = {
          type: 'subway',
          x: 0,
          y: roadPosition + 1,
          width: cityLength,
          height: subwayHeight
        };
        cityLayout.push(subway);

        // Generate the buildings
        for (const buildingData of buildings) {
          const buildingHeight = getRandomNumber(minBuildingHeight, cityHeight * 0.20);
		      const x = buildingData[0]
          const buildingWidth = buildingData[1]

          const building = {
            type: 'building',
            x: x,
            y: roadPosition - buildingHeight,
            width: buildingWidth,
            height: buildingHeight
          };
          cityLayout.push(building);

          // Generate the connecting rectangle to the subway

          const connectingRectangle = {
            type: 'connecting',
            x: building.x + (buildingWidth / 2) - (0.5),
            y: roadPosition - buildingHeight,
            width: 1,
            height: buildingHeight + subwayHeight
          };
          cityLayout.push(connectingRectangle);
        }



        return cityLayout;
      }

      // Draw the city layout on the canvas
      function drawCityLayout(cityLayout, pixelPerUnit) {
        var ctx = canvas.getContext('2d');

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        for (var i = 0; i < cityLayout.length; i++) {
          var shape = cityLayout[i];

          switch (shape.type) {
            case 'road':
              ctx.fillStyle = '#808080'; // gray
              break;
            case 'building':
              ctx.fillStyle = '#ff0000'; // red
              break;
            case 'connecting':
              ctx.fillStyle = '#0000ff'; // blue
              break;
            case 'subway':
              ctx.fillStyle = '#00ff00'; // green
              break;
          }

          ctx.fillRect(shape.x * pixelPerUnit, shape.y * pixelPerUnit, shape.width * pixelPerUnit, shape.height * pixelPerUnit);
        }
      }

      // Example usage
      const pixelPerUnit = 5
      const cityLength = canvasWidth / pixelPerUnit
      const cityHeight = canvasHeight / pixelPerUnit
      const minBuildingHeight = 20;
      const minBuildingWidth = 5
      const maxBuildingWidth = 10
      const minBuildingDistance = 0
      const maxBuildingDistance = 0
      const subwayHeight = 2;
      

      document.addEventListener('DOMContentLoaded', function() {
        var randomCity = generateRandomCity(cityLength, cityHeight, minBuildingHeight, subwayHeight, minBuildingWidth, maxBuildingWidth, minBuildingDistance, maxBuildingDistance);
        drawCityLayout(randomCity, pixelPerUnit);
      });
    </script>
  </body>
</html>
